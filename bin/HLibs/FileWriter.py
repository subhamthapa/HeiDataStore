""""This code writes the data generated by TableCreatorDynamic  into a file which can be later reloaded"""
import os


class FileWriter(object):
    def write(self, datastore_name, table_object, key_index, data_index, file=None, flag=False):
        try:
            if not flag:
                os.mkdir("..\\..\\datastore\\" + datastore_name)
        except WindowsError:
            pass
        finally:
            if file is None:
                file = open("..\\..\\datastore\\" + datastore_name + "\\" + table_object.getdata(0, 0).split()[1], "w")
            file.write("&&&" + table_object.getdata(0, 0).replace(" ", "[]") + "\n")
            j = 1
            for key in key_index:
                file.write("{{" + key)
                while j < data_index[key]:
                    data = table_object.getdata(key_index[key], j)
                    file.write("[]" + str(data))
                    j += 1
                file.write("\n")
                j = 1
            file.write("%%%EndRecord:[]\n")
            file.flush()
            file.close()

    def delete_folder(self, path):
        os.rmdir(path)


